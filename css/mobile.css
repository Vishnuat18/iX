/* iX Platform - Premium Mobile Navigation & Responsive Overhaul */

@media (max-width: 991px) {
    :root {
        --header-height: 65px;
        --bottom-nav-height: 85px;
        --pill-bg: rgba(255, 255, 255, 0.08);
        --pill-active: var(--accent-primary);
        --drawer-width: 300px;
    }

    body {
        padding-bottom: var(--bottom-nav-height);
        overflow-x: hidden;
    }

    /* 1. Mobile-First Header Overhaul */
    .header-v2 {
        display: none !important;
        /* Hide standard desktop header */
    }

    .mobile-header {
        display: flex !important;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--header-height);
        background: rgba(11, 11, 20, 0.9);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--glass-border);
        z-index: 2000;
        padding: 0 15px;
        justify-content: space-between;
        align-items: center;
    }

    .mobile-header-left {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.85rem;
        color: #888;
    }

    .mobile-header-left a {
        color: var(--accent-primary);
        font-weight: 500;
    }

    .mobile-header-right {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .mobile-section-logo {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 700;
        font-size: 1.1rem;
        background: linear-gradient(to right, var(--accent-primary), var(--accent-secondary));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }

    .mobile-menu-trigger {
        font-size: 1.4rem;
        color: #fff;
        cursor: pointer;
    }

    /* 2. Mobile Side Drawer (Right-side) */
    .mobile-drawer {
        position: fixed;
        top: 0;
        right: -100%;
        width: var(--drawer-width);
        height: 100vh;
        background: #0b0b14;
        border-left: 1px solid var(--glass-border);
        z-index: 3000;
        transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        padding: 30px 20px;
        display: flex;
        flex-direction: column;
        gap: 25px;
        box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
    }

    .mobile-drawer.active {
        right: 0;
    }

    .drawer-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(5px);
        z-index: 2999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
    }

    .drawer-overlay.active {
        opacity: 1;
        pointer-events: auto;
    }

    .drawer-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .drawer-profile {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: var(--pill-bg);
        border-radius: 20px;
        border: 1px solid var(--glass-border);
    }

    .drawer-nav-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .drawer-nav-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 12px 20px;
        font-size: 1.1rem;
        color: #fff;
        border-radius: 15px;
        transition: background 0.2s;
    }

    .drawer-nav-item:active {
        background: var(--accent-primary);
        color: #000;
    }

    /* 3. Premium Bottom Navigation */
    .mobile-bottom-nav {
        display: flex !important;
        position: fixed;
        bottom: 15px;
        left: 15px;
        right: 15px;
        height: 70px;
        background: rgba(20, 20, 30, 0.95);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 35px;
        justify-content: space-around;
        align-items: center;
        z-index: 2500;
        padding: 0 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
    }

    .mobile-nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        color: rgba(255, 255, 255, 0.4);
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .mobile-nav-item i {
        font-size: 1.3rem;
    }

    .mobile-nav-item span {
        display: none;
        /* Text only on active pill */
    }

    .mobile-nav-item.active {
        background: var(--accent-primary);
        color: #000;
        width: 100px;
        flex-direction: row;
        gap: 8px;
    }

    .mobile-nav-item.active span {
        display: block;
        font-weight: 700;
        font-size: 0.85rem;
    }

    /* 4. Switch Pills (Top of Module Views) */
    .mobile-switch-container {
        display: flex;
        justify-content: center;
        padding: 15px;
        margin-top: calc(var(--header-height) + 10px);
    }

    .switch-pill {
        display: flex;
        background: var(--pill-bg);
        padding: 5px;
        border-radius: 30px;
        border: 1px solid var(--glass-border);
        width: fit-content;
    }

    .switch-option {
        padding: 8px 18px;
        border-radius: 25px;
        font-size: 0.85rem;
        font-weight: 600;
        color: #888;
        transition: all 0.3s;
        cursor: pointer;
    }

    .switch-option.active {
        background: var(--accent-primary);
        color: #000;
        box-shadow: 0 0 15px rgba(0, 242, 255, 0.4);
    }

    /* 5. Profile & Dashboard Optimizations (Mobile Only) */
    .profile-v2-wrapper,
    .dashboard-v2-wrapper {
        flex-direction: column !important;
        padding-top: calc(var(--header-height) + 20px) !important;
    }

    .profile-v2-sidebar,
    .dashboard-v2-sidebar {
        display: none !important;
        /* Sidebar functionality moved to hamburger drawer */
    }

    .profile-v2-content,
    .dashboard-v2-content {
        padding: 15px !important;
    }

    .profile-top-section {
        flex-direction: column !important;
        align-items: center !important;
        text-align: center;
        gap: 20px !important;
    }

    .avatar-large-v2 {
        width: 120px !important;
        height: 120px !important;
        font-size: 2.5rem !important;
    }

    .details-grid-v2 {
        grid-template-columns: 1fr !important;
        /* Single column for mobile */
        gap: 20px !important;
        text-align: left;
    }

    .profile-v2-card-header {
        padding: 15px !important;
    }

    .profile-v2-card-header h3 {
        font-size: 0.95rem !important;
    }

    .btn-edit-v2 {
        width: 100%;
        margin-top: 10px;
    }

    /* Dashboard Stats Stacking */
    .dashboard-v2-stats {
        grid-template-columns: 1fr !important;
        gap: 15px !important;
    }

    /* Grid Stacking */
    .pillar-grid,
    .grid,
    .categories .grid {
        grid-template-columns: 1fr !important;
        gap: 20px !important;
        padding: 10px !important;
    }

    #statsBreakdown {
        gap: 10px !important;
    }

    .hero h1 {
        font-size: 2.2rem !important;
    }

    /* 6. Conflict Resolution - Hide redundant static elements on mobile */
    .btn-back,
    .back-btn,
    .btn-back-global,
    .back-link,
    .sub-header,
    .breadcrumb-nav,
    .interview-header-v3,
    .header-module,
    .header-v2,
    .courses-header,
    .top-bar:not(.mobile-header),
    .breadcrumb-v2,
    .header-left .breadcrumbs,
    .close-header-btn,
    .quiz-container a[href*="index.html"],
    header nav,
    header .logo:not(.mobile-section-logo) {
        display: none !important;
    }

    /* Fix for overlapping content on wizard pages */
    .app-container,
    .phase-container {
        padding-top: var(--header-height) !important;
    }

    .setup-layout-premium {
        flex-direction: column !important;
        padding-top: 10px !important;
        gap: 15px !important;
    }

    .setup-progress-sidebar {
        width: 100% !important;
        flex-direction: row !important;
        justify-content: center !important;
        margin-bottom: 5px !important;
        padding-top: 5px !important;
    }

    .step-line {
        width: 15px !important;
        height: 2px !important;
        margin: 18px 8px 0 !important;
    }

    .selection-box-premium {
        grid-template-columns: 1fr !important;
        padding: 15px !important;
        gap: 12px !important;
        margin: 0 !important;
    }

    .ultra-select {
        font-size: 0.95rem !important;
        padding: 10px 12px !important;
        background-color: #0f172a !important;
        color: #ffffff !important;
    }

    /* 7. Problem Solving & Debug Mobile Optimization */
    .quiz-container {
        padding: 5px !important;
    }

    .quiz-container>div:first-child {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 15px !important;
    }

    .quiz-container h1 {
        font-size: 2rem !important;
    }

    .quiz-container p {
        font-size: 0.9rem !important;
    }

    /* XP Badge optimization */
    .quiz-container>div:first-child>div:last-child {
        width: 100% !important;
        text-align: center !important;
        padding: 10px !important;
    }

    .controls-bar {
        flex-direction: column !important;
        gap: 10px !important;
    }

    .search-input,
    .filter-select,
    .filter-btn {
        width: 100% !important;
        min-width: 0 !important;
    }

    .problem-row {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 15px !important;
        padding: 15px !important;
    }

    .problem-row.solved {
        border-color: #00ff9d !important;
        background: rgba(0, 255, 157, 0.05) !important;
    }

    .problem-row>div:last-child {
        width: 100% !important;
        justify-content: space-between !important;
    }

    /* Debug Challenge Specifics */
    .debug-row {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 12px !important;
        padding: 15px !important;
    }

    .debug-row.solved {
        border-color: #00ff9d !important;
        background: rgba(0, 255, 157, 0.05) !important;
        box-shadow: inset 0 0 10px rgba(0, 255, 157, 0.1);
    }

    .debug-row h3 {
        font-size: 1rem !important;
    }
}